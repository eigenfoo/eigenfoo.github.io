<!doctype html><html lang=en><head><meta http-equiv=x-clacks-overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://www.georgeho.org/favicon.ico><title>How Many Cryptic Crossword Grids Are There? | George Ho</title><meta name=title content="How Many Cryptic Crossword Grids Are There?"><meta name=description content="Counting the number of valid American-style crossword grids is more or less a solved problem. For example, see this FiveThirtyEight Riddler and Michael Kleber&rsquo;s answer in a Twitter thread.
However, the same doesn&rsquo;t seem to be true for British-style cryptic crosswords. Hence this blog post!
Now, counting the number of valid grids is a different task from enumerating them, and it&rsquo;s a bad idea to do the former by doing the latter, because the sheer number of grids can be prohibitively expensive to compute."><meta name=keywords content><meta property="og:title" content="How Many Cryptic Crossword Grids Are There?"><meta property="og:description" content="Counting the number of valid American-style crossword grids is more or less a solved problem. For example, see this FiveThirtyEight Riddler and Michael Kleber&rsquo;s answer in a Twitter thread.
However, the same doesn&rsquo;t seem to be true for British-style cryptic crosswords. Hence this blog post!
Now, counting the number of valid grids is a different task from enumerating them, and it&rsquo;s a bad idea to do the former by doing the latter, because the sheer number of grids can be prohibitively expensive to compute."><meta property="og:type" content="article"><meta property="og:url" content="https://www.georgeho.org/counting-cryptics/"><meta property="og:image" content="https://www.georgeho.org/assets/images/asterism.png"><meta property="article:section" content="blog"><meta property="article:published_time" content="2021-05-17T00:00:00+00:00"><meta property="article:modified_time" content="2021-05-17T00:00:00+00:00"><meta property="og:site_name" content="⁂ George Ho"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.georgeho.org/assets/images/asterism.png"><meta name=twitter:title content="How Many Cryptic Crossword Grids Are There?"><meta name=twitter:description content="Counting the number of valid American-style crossword grids is more or less a solved problem. For example, see this FiveThirtyEight Riddler and Michael Kleber&rsquo;s answer in a Twitter thread.
However, the same doesn&rsquo;t seem to be true for British-style cryptic crosswords. Hence this blog post!
Now, counting the number of valid grids is a different task from enumerating them, and it&rsquo;s a bad idea to do the former by doing the latter, because the sheer number of grids can be prohibitively expensive to compute."><meta itemprop=name content="How Many Cryptic Crossword Grids Are There?"><meta itemprop=description content="Counting the number of valid American-style crossword grids is more or less a solved problem. For example, see this FiveThirtyEight Riddler and Michael Kleber&rsquo;s answer in a Twitter thread.
However, the same doesn&rsquo;t seem to be true for British-style cryptic crosswords. Hence this blog post!
Now, counting the number of valid grids is a different task from enumerating them, and it&rsquo;s a bad idea to do the former by doing the latter, because the sheer number of grids can be prohibitively expensive to compute."><meta itemprop=datePublished content="2021-05-17T00:00:00+00:00"><meta itemprop=dateModified content="2021-05-17T00:00:00+00:00"><meta itemprop=wordCount content="1118"><meta itemprop=image content="https://www.georgeho.org/assets/images/asterism.png"><meta itemprop=keywords content><meta name=referrer content="no-referrer-when-downgrade"><style>body{font-family:Verdana,sans-serif;margin:auto;padding:20px;max-width:720px;text-align:left;background-color:#fff;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444}h1,h2,h3,h4,h5,h6,strong,b{color:#222}a{color:#3273dc}.title{text-decoration:none;border:0}.title span{font-weight:400}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}pre code{color:#222;display:block;padding:20px;white-space:pre-wrap;font-size:14px}div.highlight pre{background-color:initial;color:initial}div.highlight code{background-color:unset;color:unset}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}footer{padding:25px;text-align:center}.helptext{color:#777;font-size:small}.errorlist{color:#eba613;font-size:small}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:#8b6fcb}@media(prefers-color-scheme:dark){body{background-color:#333;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#777}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}.helptext{color:#aaa}}</style><script type=text/javascript src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type=text/x-mathjax-config>
  MathJax.Hub.Config({ tex2jax: {inlineMath: [["$", "$"]]} })
</script><script async src=//static.getclicky.com/101349618.js></script><noscript><p><img alt=Clicky width=1 height=1 src=//in.getclicky.com/101349618ns.gif></p></noscript><link rel=stylesheet media=all href=/assets/fonts/nicholson-gothic.css type=text/css><link rel=stylesheet media=all href=/assets/fonts/triplicate-a.css type=text/css><script type=text/javascript>navigator.appVersion.indexOf("Win")!=-1?document.write('<link rel="stylesheet" type="text/css" media="all" href="/assets/fonts/equity-a.css"/>'):navigator.appVersion.indexOf("Mac")!=-1?navigator.userAgent.match(/iPad/i)!=null?(document.write('<link rel="stylesheet" media="only screen and (max-device-width: 1024px)" href="/assets/fonts/equity-b.css" type="text/css"/>'),document.write('<link rel="stylesheet" media="only screen and (min-device-width: 768px) and (max-device-width: 1024px) and (-webkit-min-device-pixel-ratio: 2)" type="text/css" href="/assets/fonts/equity-a.css"/>')):document.write('<link rel="stylesheet" type="text/css" media="all" href="/assets/fonts/equity-b.css"/>'):document.write('<link rel="stylesheet" type="text/css" media="all" href="/assets/fonts/equity-a.css"/>')</script><style>html{font-size:18px;font-size:min(max(18px,4vw),26px)}content{line-height:1.45}body{max-width:800px;font-family:Equity,times new roman,Palatino,serif;background-color:#fffff8}code{font-family:Triplicate,lucida console,monospace;font-size:85%;background-color:unset}pre code{white-space:pre;overflow-x:auto;font-size:14px;font-size:min(max(12px,2vw),16px);text-size-adjust:100%;-ms-text-size-adjust:100%;-moz-text-size-adjust:100%;-webkit-text-size-adjust:100%}h1,h2,h3,h4,h5,h6{font-family:NicholsonGothic,Verdana,sans-serif;line-height:1.25}h2,h3,h4,h5,h6{margin-top:8%;margin-bottom:-1%}nav{margin-top:3%;margin-bottom:5%}p.wide-embeds{position:relative;left:50%;transform:translate(-50%,0);width:90vw}ul.blog-posts li span{flex:0 0 140px}.revue-form-group,.revue-form-actions{display:inline-block}input[type=email]{font-family:Triplicate,lucida console,monospace;font-size:80%}input[type=submit]{font-family:Equity,times new roman,Palatino,serif;font-size:80%}@media(prefers-color-scheme:dark){body{background-color:#111}}</style></head><body><header><a href=/ class=title><h2>⁂ George Ho</h2></a><nav><a href=/>Home</a>
<a href=/blog>Blog</a>
<a href=/crosswords/>Crosswords</a>
<a href=/work/>Work</a></nav></header><main><h1>How Many Cryptic Crossword Grids Are There?</h1><p><i><time datetime=2021-05-17 pubdate>2021-05-17</time></i></p><content><p>Counting the number of valid American-style crossword grids is more or less a
solved problem. For example, see this <a href=https://fivethirtyeight.com/features/how-many-crossword-puzzles-can-you-make/>FiveThirtyEight
Riddler</a>
and <a href=https://twitter.com/Log3overLog2/status/1092472516571000839>Michael Kleber&rsquo;s answer in a Twitter
thread</a>.</p><p>However, the same doesn&rsquo;t seem to be true for British-style cryptic crosswords.
Hence this blog post!</p><p>Now, <em>counting</em> the number of valid grids is a different task from
<em>enumerating</em> them, and it&rsquo;s a bad idea to do the former by doing the latter,
because the sheer number of grids can be prohibitively expensive to compute.
However, I&rsquo;m mostly interested in grids smaller than 11×11, and I actually
<em>wanted</em> to see all possible grids, so I went ahead and did the inadvisable.</p><p>So let&rsquo;s jump right in! If you&rsquo;re just interested in the numbers and a list of
all valid grids, feel free to scroll to the very end.</p><h2 id=what-makes-a-valid-cryptic-grid>What Makes A Valid Cryptic Grid?</h2><ol><li>The grid must be <strong>rotationally symmetric</strong>.</li><li>The grid length (i.e. the length of one side of the grid) must be an <strong>odd
number</strong>.</li><li>All white squares must be <strong>connected</strong>: that is, there can be only one
contiguous island of white squares.</li><li>All words must have <strong>half their letters checked</strong>.<ul><li>For words of odd length, there&rsquo;s some ambiguity: depending on who you talk
to, either &ldquo;half rounded up&rdquo; or &ldquo;half rounded up or down&rdquo; must be checked.</li><li>For the purposes of this blog post, I required &ldquo;half rounded up&rdquo;.</li></ul></li><li>There <strong>cannot be more than two consecutive unchecked squares</strong>.</li><li>Two consecutive unchecked squares <strong>cannot occur at the start or end of a
word</strong>.<ul><li>I haven&rsquo;t found much explicit mention of this rule other than <a href=https://www.crosswordunclued.com/2009/09/crossword-grid-checking.html>this blog
post</a>
saying that it&rsquo;s a &ldquo;house rule&rdquo; at <em>The Times</em> of London, but all cryptics
I&rsquo;ve seen have hewed to this requirement, so I enforced it.</li></ul></li></ol><p>It&rsquo;s also worth noting that different constructors and publications have
different &ldquo;house rules&rdquo;. For example:</p><ul><li>Some publications have upper and/or lower limits on the number of clues. For
example, <a href=https://www.ft.com/crossword>the <em>Financial Times</em></a> seems to
always have exactly 32 clues.</li><li>Some constructors also restrict the size of black islands: for example, there
cannot be a contiguous black island of more than five squares.</li></ul><p>I didn&rsquo;t enforce these rules, more out of laziness and lack of time than
technical infeasibility.</p><h2 id=generating-cryptic-grids>Generating Cryptic Grids</h2><p>Akshay Ravikumar has an <a href=https://akshayr.xyz/blog/articles/counting-crosswords>excellent blog
post</a> explaining how he
generated American crosswords, and if you&rsquo;re interested in diving deeper I
highly recommend reading his exposition: my algorithm is more or less directly
lifted from his work, just adapted to cryptic crosswords.</p><p>Here&rsquo;s the final algorithm that I used:</p><ol><li>Precompute all <code>valid_rows</code> and <code>symmetric_rows</code>: for a cryptic, these are
rows that don&rsquo;t have words below the minimum word length.</li><li>Using <code>valid_rows</code> and <code>symmetric_rows</code>, find all sets of valid middle three
rows &mdash; for example, for an 11×11 grid, find all possible fifth, sixth and
seventh rows.<ul><li>Note that the middle row must be symmetric, and the two adjacent rows must
be mirror images of each other.</li></ul></li><li>From the middle rows outward, build up a grid in a depth-first search.<ul><li>Before adding a new row, make sure that it satisfies the checking
requirement: that it has the correct number of unchecked squares and has
at most two consecutive unchecked squares not at the start or end of
words.</li><li>There is also a trick we can use to limit the search space: if the
previous three rows have a column that is black-white-white, then in the
same column, the next row must be white.</li><li>This is best explained pictorially:
<img src=/assets/images/counting-cryptics-illustration.png alt="An illustration of the black-black-whitetrick"></li></ul></li><li>Check that the columns are valid. Specifically:<ul><li>Check that the columns are <code>valid_rows</code> (this ensures that there are no
words below the minimum word length).</li><li>And also check that the columns don&rsquo;t have two consecutive unchecked
squares at the start or end of the word.</li><li>Note that all other requirements (e.g. the number of checked squares) are
already taken care up while building up the grid.</li></ul></li><li>Check connectedness of the grid using a <a href=https://www.hackerearth.com/practice/algorithms/graphs/depth-first-search/tutorial/>depth-first
search</a>.</li></ol><p>This algorithm works well and runs reasonably quickly (i.e. in less than a
minute) for 5×5 and 7×7 grids, but at 9×9 the search time becomes significant
(around half an hour on a MacBook Pro). Additionally, some valid grids aren&rsquo;t
very interesting as &ldquo;real&rdquo; crosswords, such as the one below.</p><center><pre><code>
⬛⬛⬛⬛⬜⬜⬜
⬛⬛⬛⬛⬜⬛⬜
⬛⬛⬛⬛⬜⬛⬜
⬜⬜⬜⬜⬜⬜⬜
⬜⬛⬜⬛⬛⬛⬛
⬜⬛⬜⬛⬛⬛⬛
⬜⬜⬜⬛⬛⬛⬛
</code></pre></center><p>It&rsquo;s not very interesting because of the sheer number of black squares (and
correspondingly low number of clues). So to winnow down the grids more, I
filtered <code>valid_rows</code> before I start: <code>valid_rows</code> must have a minimum number
of white squares: 2 squares for 5×5 and 3 squares for 7×7 through 13×13.
Anecdotally, this reduces the computation time by a factor of three or four. I
call the grids produced in this reduced search <em>&ldquo;interesting grids&rdquo;,</em> as
opposed to <em>&ldquo;valid grids&rdquo;</em>.</p><p>I should note that there are definitely more ways to speed up the search: I
could&rsquo;ve parallelize the search (i.e. assign each worker a subset of the valid
middle rows), I could&rsquo;ve written the program in a language faster than Python
(like Julia), and further algorithmic speedups are possible (e.g. checking
columns after adding each row would prune more grids earlier, instead of
deferring the column checks to after the grid is constructed).</p><p>At any rate, I just ran the program on my laptop, and stopped at 9×9 grids.
Results below!</p><h2 id=results>Results</h2><p>If you&rsquo;ve just scrolled down here, the only thing you need to note is that an
<em>&ldquo;interesting grid&rdquo;</em> is one in which every row has at least a certain number of
white squares: 2 for 5×5 grids and 3 for 7×7 grids onwards.</p><p>For comparison, I&rsquo;ve added the number of valid American grids, taken from
<a href=https://twitter.com/Log3overLog2/status/1092795679947264000>Michael Kleber&rsquo;s corrected
Tweet</a>.</p><table><thead><tr><th style=text-align:center>Grid Size</th><th style=text-align:right>Valid Grids</th><th style=text-align:right>Interesting Grids</th><th style=text-align:right>American Grids</th></tr></thead><tbody><tr><td style=text-align:center>5×5</td><td style=text-align:right>17</td><td style=text-align:right>9</td><td style=text-align:right>12</td></tr><tr><td style=text-align:center>7×7</td><td style=text-align:right>346</td><td style=text-align:right>43</td><td style=text-align:right>312</td></tr><tr><td style=text-align:center>9×9</td><td style=text-align:right>9,381</td><td style=text-align:right>334</td><td style=text-align:right>31,187</td></tr><tr><td style=text-align:center>11×11</td><td style=text-align:right>N/A</td><td style=text-align:right>N/A</td><td style=text-align:right>17,438,702</td></tr><tr><td style=text-align:center>13×13</td><td style=text-align:right>N/A</td><td style=text-align:right>N/A</td><td style=text-align:right>40,575,832,476</td></tr><tr><td style=text-align:center>15×15</td><td style=text-align:right>N/A</td><td style=text-align:right>N/A</td><td style=text-align:right>404,139,015,237,875</td></tr></tbody></table><p>There are 346 valid 7×7 cryptics &mdash; interestingly, slightly more than the
pleasing 6 × 52 = 312 valid American-style crosswords which inspired <a href=https://www.7xwords.com/why.html>Malaika
Handa&rsquo;s 7xwords</a>; disappointingly,
factorizing into a not-at-all-auspicious 2 × 173.</p><p>For larger grid lengths, there appear to be far fewer valid cryptic grids than
American grids, probably owing to the more stringent conditions for cryptics.</p><p>It was infeasible for me to run my program for 11×11 grids onwards &mdash; either I
need to put a lot more effort in optimizing my program, or (more likely) it&rsquo;s
simply computationally intractable to enumerate all possible grids, and we can
only count them. If I&rsquo;m inspired to pick up this line of work again, I&rsquo;ll be
sure to post a part two!</p><p>And finally, the code:</p><ul><li><a href=https://github.com/eigenfoo/counting-cryptics>Source code (Python Jupyter Notebook)</a></li><li>Valid grids<ul><li><a href=https://raw.githubusercontent.com/eigenfoo/counting-cryptics/main/valid_5x5_grids.txt>5×5</a></li><li><a href=https://raw.githubusercontent.com/eigenfoo/counting-cryptics/main/valid_7x7_grids.txt>7×7</a></li><li><a href=https://raw.githubusercontent.com/eigenfoo/counting-cryptics/main/valid_9x9_grids.txt>9×9</a></li></ul></li><li>Interesting grids<ul><li><a href=https://raw.githubusercontent.com/eigenfoo/counting-cryptics/main/interesting_5x5_grids.txt>5×5</a></li><li><a href=https://raw.githubusercontent.com/eigenfoo/counting-cryptics/main/interesting_7x7_grids.txt>7×7</a></li><li><a href=https://raw.githubusercontent.com/eigenfoo/counting-cryptics/main/interesting_9x9_grids.txt>9×9</a></li></ul></li></ul></content><p></p></main><footer><form action=https://buttondown.email/api/emails/embed-subscribe/eigenfoo method=post target=popupwindow onsubmit='window.open("https://buttondown.email/eigenfoo","popupwindow")' class=embeddable-buttondown-form><label for=bd-email>Get my (monthly?) blog posts over email:</label><br><input type=email name=email id=bd-email placeholder=your@email.com>
<input type=submit value=Subscribe></form></footer></body></html>